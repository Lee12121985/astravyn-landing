<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Astravyn Landing Page</title>

  <!-- Embedded CSS (self-contained so layout won't break) -->
  <style>
    /* --- Page & background --- */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Montserrat:wght@700&display=swap');

    html,
    body {
      height: 100%;
      margin: 0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    body {
      background: url("assets/starry-night.jpg") no-repeat center center fixed;
      background-size: cover;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      color: #fff;
    }

    /* --- Center wrapper --- */
    .landing-wrap {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 48px 20px;
      box-sizing: border-box;
    }

    /* --- Glossy card --- */
    .card {
      width: 100%;
      max-width: 980px;
      background: linear-gradient(180deg, rgba(10, 30, 46, 0.75), rgba(6, 20, 33, 0.60));
      border-radius: 18px;
      padding: 36px;
      text-align: center;
      box-shadow: 0 30px 80px rgba(2, 8, 18, 0.7);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.04);
    }

    /* --- Logo with sharp style (Montserrat) --- */
    .logo {
      font-family: "Montserrat", sans-serif;
      font-size: 48px;
      margin: 0 0 6px;
      color: #fff;
      font-weight: 700;
      letter-spacing: -1px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.35);
    }

    .tagline {
      color: rgba(255, 255, 255, 0.9);
      margin: 0 0 12px;
      font-size: 16px;
    }

    .sub {
      color: rgba(255, 255, 255, 0.85);
      margin-top: 10px;
      font-size: 15px;
    }

    /* --- Top CTA group --- */
    .cta-row {
      margin-top: 18px;
      display: flex;
      gap: 12px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .ts-open-btn {
      display: inline-block;
      padding: 14px 28px;
      border-radius: 40px;
      background: #fff;
      color: #0b2540;
      font-weight: 700;
      font-size: 16px;
      text-decoration: none;
      box-shadow: 0 10px 36px rgba(11, 15, 25, 0.18);
      transition: transform .14s ease, box-shadow .14s ease;
    }

    .ts-open-btn:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 46px rgba(11, 15, 25, 0.24);
    }

    .ai-launch-btn {
      display: inline-block;
      padding: 14px 20px;
      border-radius: 40px;
      background: linear-gradient(90deg, #06b6d4, #3b82f6);
      color: #fff;
      font-weight: 700;
      font-size: 15px;
      text-decoration: none;
      box-shadow: 0 10px 36px rgba(6, 16, 40, 0.28);
      transition: transform .14s ease, box-shadow .14s ease;
    }

    .ai-launch-btn:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 46px rgba(6, 16, 40, 0.36);
    }

    /* --- Apps Grid --- */
    .apps-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-top: 34px;
      align-items: start;
    }

    .app-card {
      background: rgba(255, 255, 255, 0.04);
      border-radius: 12px;
      padding: 18px;
      text-align: left;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.35);
      border: 1px solid rgba(255, 255, 255, 0.03);
      transition: transform .14s ease, box-shadow .18s ease, border-color .18s ease;
    }

    .app-card:hover {
      transform: translateY(-6px);
    }

    .app-title {
      color: #fff;
      font-weight: 700;
      margin: 0 0 6px;
      font-size: 16px;
    }

    .app-desc {
      color: rgba(255, 255, 255, 0.82);
      margin: 0 0 12px;
      font-size: 14px;
      line-height: 1.35;
    }

    .app-actions {
      display: flex;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }

    .btn {
      padding: 8px 12px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      font-size: 14px;
      display: inline-block;
    }

    .btn-primary {
      background: #0b2540;
      color: #fff;
      border: none;
      box-shadow: 0 8px 20px rgba(11, 15, 25, 0.25);
    }

    .btn-light {
      background: rgba(255, 255, 255, 0.95);
      color: #0b2540;
    }

    .coming {
      background: rgba(255, 255, 255, 0.12);
      color: rgba(255, 255, 255, 0.8);
      pointer-events: none;
    }

    /* --- AI Special hover glow --- */
    .app-card.ai-card:hover {
      box-shadow: 0 14px 48px rgba(3, 169, 244, 0.18);
      border-color: rgba(3, 169, 244, 0.18);
      transform: translateY(-8px) scale(1.02);
    }

    /* --- Footer --- */
    .card-footer {
      margin-top: 22px;
      color: rgba(255, 255, 255, 0.75);
      font-size: 13px;
    }

    @media (max-width:560px) {
      .logo {
        font-size: 40px;
      }

      .card {
        padding: 20px;
      }
    }

    /* --- Auth / user area (top-right) --- */
    .login-btn,
    .signup-btn {
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.7);
      color: #fff;
      background: transparent;
      font-size: 13px;
      text-decoration: none;
      font-weight: 600;
      margin-left: 4px;
    }

    .login-btn:hover,
    .signup-btn:hover {
      background: rgba(15, 23, 42, 0.28);
    }

    .user-dropdown {
      display: inline-block;
      position: relative;
    }

    .user-chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-size: 13px;
      color: rgba(255, 255, 255, 0.94);
    }

    .user-avatar {
      width: 28px;
      height: 28px;
      border-radius: 999px;
      background: linear-gradient(135deg, #4f46e5, #06b6d4);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      font-size: 13px;
      font-weight: 700;
      color: #fff;
      overflow: hidden;
    }

    .user-avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .user-name {
      max-width: 140px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .user-menu {
      position: absolute;
      right: 0;
      margin-top: 8px;
      background: rgba(15, 23, 42, 0.96);
      border-radius: 10px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.8);
      min-width: 180px;
      display: none;
      z-index: 50;
    }

    .user-menu-item {
      padding: 8px 12px;
      font-size: 12px;
      color: rgba(226, 232, 240, 0.96);
      cursor: pointer;
    }

    .user-menu-item.muted {
      font-size: 11px;
      color: rgba(148, 163, 184, 0.95);
      cursor: default;
    }

    .user-menu-item:hover:not(.muted) {
      background: rgba(30, 64, 175, 0.7);
    }
  </style>
</head>

<body>
  <div class="landing-wrap">
    <div class="card" role="main" aria-label="Astravyn landing">
      <!-- auth UI container (top-right) -->
      <div id="auth-container" style="text-align:right;"></div>

      <h1 class="logo">Astravyn</h1>
      <p class="tagline">Discover, Create & Connect ‚Äî The Astravyn Way</p>
      <p class="sub">Because every idea deserves a place to shine. Explore elegant tools and apps ‚Äî growing from
        one hub.</p>

      <!-- Top buttons -->
      <div class="cta-row" aria-hidden="false">
        <a class="ts-open-btn" href="timesheet/index.html" target="_blank" rel="noopener noreferrer">
          üïí Open Timesheet ‚Äî Free to use
        </a>
        <a class="ai-launch-btn" href="ai/index.html" target="_blank" rel="noopener noreferrer">
          ü§ñ Launch AI Studio
        </a>
      </div>

      <!-- Apps Grid -->
      <div class="apps-grid" aria-live="polite">
        <!-- Timesheet -->
        <div class="app-card">
          <div class="app-title">‚è± Timesheet Tracker</div>
          <div class="app-desc">Quickly mark attendance, export detailed CSV/XLSX reports, and keep monthly
            summaries.</div>
          <div class="app-actions">
            <a class="btn btn-light" href="timesheet/index.html" target="_blank"
              rel="noopener noreferrer">Open</a>
            <a class="btn coming" href="#" aria-disabled="true">Mobile App (Soon)</a>
          </div>
        </div>

        <!-- AI Studio -->
        <div class="app-card ai-card">
          <div class="app-title">ü§ñ AI Studio</div>
          <div class="app-desc">Generate AI images, portraits, and creative morphs with one click ‚Äî experience
            AstraVyn‚Äôs AI magic.</div>
          <div class="app-actions">
            <a class="btn btn-primary" href="ai/index.html" target="_blank" rel="noopener noreferrer">Open
              AI Studio</a>
            <a class="btn btn-light" href="#" onclick="alert('Mobile app coming soon!')">Mobile App
              (Soon)</a>
          </div>
        </div>

        <!-- Work Planner -->
        <div class="app-card">
          <div class="app-title">üóÇ Work Planner (coming)</div>
          <div class="app-desc">Plan your day, set priorities, and track progress. Light & distraction-free.
          </div>
          <div class="app-actions">
            <a class="btn coming" href="#" aria-disabled="true">Coming Soon</a>
            <a class="btn coming" href="#" aria-disabled="true">Notify Me</a>
          </div>
        </div>

        <!-- Journal -->
        <div class="app-card">
          <div class="app-title">‚úçÔ∏è Journal & Notes (coming)</div>
          <div class="app-desc">A private place to capture thoughts, drafts and daily notes ‚Äî syncing later.
          </div>
          <div class="app-actions">
            <a class="btn coming" href="#" aria-disabled="true">Coming Soon</a>
            <a class="btn coming" href="#" aria-disabled="true">Notify Me</a>
          </div>
        </div>

        <!-- Connect -->
        <div class="app-card">
          <div class="app-title">üí¨ Connect (coming)</div>
          <div class="app-desc">Light communication tools for teams and communities ‚Äî simple, secure, private.
          </div>
          <div class="app-actions">
            <a class="btn coming" href="#" aria-disabled="true">Coming Soon</a>
            <a class="btn coming" href="#" aria-disabled="true">Notify Me</a>
          </div>
        </div>

        <!-- Dating App -->
        <div class="app-card" style="border-color: rgba(236, 72, 153, 0.3);">
          <div class="app-title" style="color: #f472b6;">üíñ Dating</div>
          <div class="app-desc">Premium dating experience. Find your match in the stars.</div>
          <div class="app-actions">
            <!-- note: protected-link + data-href -->
            <a class="btn btn-light protected-link coming"
              href="#"
              data-href="dating/index.html"
              aria-disabled="true">Sign In to Access</a>
          </div>
        </div>
      </div>

      <div class="card-footer">
        ¬© 2025 Astravyn. Built with care ‚Äî new apps arriving regularly.
        <!-- Admin link: visible only for admins -->
        <a id="adminLink" href="admin/index.html"
          style="color:rgba(255,255,255,0.4); text-decoration:none; margin-left:10px; display:none;">Admin</a>
      </div>
    </div>
  </div>

  <!-- Auth + role logic -->
  <script type="module">
    import { auth, db } from './js/firebase-config.js';
    import {
      onAuthStateChanged,
      signOut
    } from 'https://www.gstatic.com/firebasejs/10.13.0/firebase-auth.js';
    import {
      doc,
      getDoc
    } from 'https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js';

    const authContainer = document.getElementById('auth-container');
    const adminLink = document.getElementById('adminLink');
    const protectedLinks = document.querySelectorAll('.protected-link');

    function setProtectedLinksLoggedOut() {
      protectedLinks.forEach(el => {
        el.classList.add('coming');
        el.removeAttribute('href');
        el.setAttribute('aria-disabled', 'true');
        el.textContent = 'Sign In to Access';
      });
    }

    function setProtectedLinksLoggedIn() {
      protectedLinks.forEach(el => {
        const target = el.dataset.href;
        if (!target) return;
        el.classList.remove('coming');
        el.setAttribute('href', target);
        el.removeAttribute('aria-disabled');
        el.textContent = 'Open';
      });
    }

    function renderLoggedOut() {
      if (!authContainer) return;
      authContainer.innerHTML = `
        <div style="margin-bottom:16px;">
          <a href="login/index.html" class="login-btn">Sign In</a>
          <a href="signup/index.html" class="signup-btn">Sign Up</a>
        </div>
      `;

      if (adminLink) {
        adminLink.style.display = 'none';
      }
      setProtectedLinksLoggedOut();
    }

    function renderLoggedIn(user) {
      if (!authContainer) return;

      const name = user.displayName || (user.email ? user.email.split('@')[0] : 'User');
      const photo = user.photoURL;
      const initial = name.charAt(0).toUpperCase();

      authContainer.innerHTML = `
        <div class="user-dropdown">
          <div class="user-chip" id="user-chip">
            ${
              photo
                ? `<div class="user-avatar"><img src="${photo}" alt="avatar" /></div>`
                : `<div class="user-avatar">${initial}</div>`
            }
            <span class="user-name">${name}</span>
          </div>
          <div class="user-menu" id="user-menu">
            <div class="user-menu-item muted">${user.email || ''}</div>
            <!-- NEW: admin menu item, initially hidden -->
            <div class="user-menu-item" id="admin-menu-item" style="display:none;">Open Admin Dashboard</div>
            <div class="user-menu-item" id="logout-btn">Sign out</div>
          </div>
        </div>
      `;

      const chip = document.getElementById('user-chip');
      const menu = document.getElementById('user-menu');
      const logoutBtn = document.getElementById('logout-btn');

      if (chip && menu) {
        chip.addEventListener('click', () => {
          const visible = menu.style.display === 'block';
          menu.style.display = visible ? 'none' : 'block';
        });

        document.addEventListener('click', (e) => {
          if (!authContainer.contains(e.target)) {
            menu.style.display = 'none';
          }
        });
      }

      if (logoutBtn) {
        logoutBtn.addEventListener('click', async () => {
          await signOut(auth);
        });
      }

      setProtectedLinksLoggedIn();

      // Show Admin link + menu item only if Firestore role is admin
      (async () => {
        if (!adminLink) return;
        const adminMenuItem = document.getElementById('admin-menu-item');

        try {
          const snap = await getDoc(doc(db, 'users', user.uid));
          if (snap.exists() && snap.data().role === 'admin') {
            adminLink.style.display = 'inline-block';

            if (adminMenuItem) {
              adminMenuItem.style.display = 'block';
              adminMenuItem.onclick = () => {
                window.location.href = 'admin/index.html';
              };
            }
          } else {
            adminLink.style.display = 'none';
            if (adminMenuItem) adminMenuItem.style.display = 'none';
          }
        } catch (e) {
          console.error('Error checking admin role', e);
          adminLink.style.display = 'none';
          if (adminMenuItem) adminMenuItem.style.display = 'none';
        }
      })();
    }

    onAuthStateChanged(auth, (user) => {
      if (user) {
        renderLoggedIn(user);
      } else {
        renderLoggedOut();
      }
    });
  </script>
</body>

</html>
